---
- config:
    - testset: "Testing recommendations url - common errors"

- test:
    - name: "Add recommendation - missing from id"
    - group: "[recommendations - errors]"
    - url: "/recommendations"
    - method: "PUT"
    - headers: {Authorization: tokenUser1}
    - body: '{"to": 1}'
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Missing from user"}
    - expected_status: [400] # bad request

- test:
    - name: "Add recommendation - missing to id"
    - group: "[recommendations - errors]"
    - url: "/recommendations"
    - method: "PUT"
    - headers: {Authorization: tokenUser1}
    - body: '{"from": 1}'
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Missing to user"}
    - expected_status: [400] # bad request

- test:
    - name: "Add recommendation - equals ids"
    - group: "[recommendations - errors]"
    - url: "/recommendations"
    - method: "PUT"
    - headers: {Authorization: tokenUser1}
    - body: '{"to": 1, "from": 1}'
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "From user and to user cannot be equals"}
    - expected_status: [400] # bad request

- test:
    - name: "Add recommendation - nonexistent to user"
    - group: "[recommendations - errors]"
    - url: "/recommendations"
    - method: "PUT"
    - headers: {Authorization: tokenUser1}
    - body: '{"to": 0, "from": 1}'
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Usuario con el id 0 no existe en el sistema"}
    - expected_status: [404] # not found

- test:
    - name: "Recommendations - GET"
    - group: "[recommendations - errors]"
    - url: "/recommendations"
    - headers: {Authorization: tokenUser1}
    - method: "GET"
    - expected_status: [501] # not implemented

- test:
    - name: "Recommendations - POST"
    - group: "[recommendations - errors]"
    - url: "/recommendations"
    - headers: {Authorization: tokenUser1}
    - method: "POST"
    - expected_status: [501] # not implemented

- test:
    - name: "Delete recommendation - missing from parameter"
    - group: "[recommendations - errors]"
    - url: "/recommendations"
    - method: "DELETE"
    - headers: {Authorization: tokenUser1}
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Missing from parameter"}
    - expected_status: [400] # bad request

- test:
    - name: "Delete recommendation - invalid from parameter"
    - group: "[recommendations - errors]"
    - url: "/recommendations?from=notANumber&to=2"
    - method: "DELETE"
    - headers: {Authorization: tokenUser1}
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Not a numeric id"}
    - expected_status: [400] # bad request

- test:
    - name: "Delete recommendation - invalid to parameter"
    - group: "[recommendations - errors]"
    - url: "/recommendations?from=1&to=notANumber"
    - method: "DELETE"
    - headers: {Authorization: tokenUser1}
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Not a numeric id"}
    - expected_status: [400] # bad request

- test:
    - name: "Delete recommendation - nonexistent user"
    - group: "[recommendations - errors]"
    - url: "/recommendations?from=1&to=12345"
    - method: "DELETE"
    - headers: {Authorization: tokenUser1}
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Usuario con el id 12345 no existe en el sistema"}
    - expected_status: [404] # not found
