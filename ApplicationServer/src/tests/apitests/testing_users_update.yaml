---
- config:
    - testset: "Testing users url - update"

- test:
    - name: "Get user data before update"
    - group: "[users - update]"
    - url: "/users/1"
    - method: "GET"
    - validators:
          - compare: {jsonpath_mini: "id", comparator: "eq", expected: 1}
          - compare: {jsonpath_mini: "first_name", comparator: "eq", expected: "john"}
          - compare: {jsonpath_mini: "last_name", comparator: "eq", expected: "doe"}
    - expected_status: [200] # ok

- test:
    - name: "Update user 1"
    - group: "[users - update]"
    - url: "/users/1"
    - method: "PUT"
    - headers: {Authorization: tokenUser1}
    - body: '{"first_name": "Juan", "last_name": "Perez", "work_history": [{"company": "IBM", "from_date": "10/2012", "to_date": "", "position_title": "developer"}], "skills": [{"category": "software", "description": "Java developer", "name": "Java"}]}'
    - expected_status: [200] # ok

- test:
    - name: "Get user data after update"
    - group: "[users - update]"
    - url: "/users/1"
    - method: "GET"
    - validators:
          - compare: {jsonpath_mini: "id", comparator: "eq", expected: 1}
          - compare: {jsonpath_mini: "first_name", comparator: "eq", expected: "juan"}
          - compare: {jsonpath_mini: "last_name", comparator: "eq", expected: "perez"}
          - compare: {jsonpath_mini: "skills.0.category", comparator: "eq", expected: "software"}
          - compare: {jsonpath_mini: "skills.0.description", comparator: "eq", expected: "Java developer"}
          - compare: {jsonpath_mini: "skills.0.name", comparator: "eq", expected: "java"}
          - compare: {jsonpath_mini: "work_history.0.company", comparator: "eq", expected: "IBM"}
          - compare: {jsonpath_mini: "work_history.0.from_date", comparator: "eq", expected: "10/2012"}
          - compare: {jsonpath_mini: "work_history.0.position_title", comparator: "eq", expected: "developer"}
          - compare: {jsonpath_mini: "work_history.0.to_date", comparator: "eq", expected: ""}
    - expected_status: [200] # ok
