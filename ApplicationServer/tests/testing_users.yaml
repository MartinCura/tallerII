---
- config:
    - testset: "Testing users url"

- test:
    - name: "Get user data - missing id"
    - url: "/users"
    - method: "GET"
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "Cannot get user id from url."}
    - expected_status: [400] # bad request

- test:
    - name: "Get user data"
    - url: "/users/1"
    - method: "GET"
    - validators:
          - compare: {jsonpath_mini: "id", comparator: "eq", expected: 1}
          - compare: {jsonpath_mini: "first_name", comparator: "eq", expected: "John"}
          - compare: {jsonpath_mini: "last_name", comparator: "eq", expected: "Doe"}
          - compare: {jsonpath_mini: "email", comparator: "eq", expected: "john@doe.com"}
          - compare: {jsonpath_mini: "date_of_birth", comparator: "eq", expected: "01/01/1990"}
          - compare: {jsonpath_mini: "city", comparator: "eq", expected: "Buenos Aires"}
          - compare: {jsonpath_mini: "summary", comparator: "eq", expected: "Hi, this is John Doe"}
          - compare: {jsonpath_mini: "location.latitude", comparator: "eq", expected: -58.368368}
          - compare: {jsonpath_mini: "location.longitude", comparator: "eq", expected: -34.617589}
          - compare: {jsonpath_mini: "skills.0.category", comparator: "eq", expected: "software"}
          - compare: {jsonpath_mini: "skills.0.description", comparator: "eq", expected: "JavaScrip programming language"}
          - compare: {jsonpath_mini: "skills.0.name", comparator: "eq", expected: "JavaScript"}
          - compare: {jsonpath_mini: "skills.1.category", comparator: "eq", expected: "management"}
          - compare: {jsonpath_mini: "skills.1.description", comparator: "eq", expected: "Project Management"}
          - compare: {jsonpath_mini: "skills.1.name", comparator: "eq", expected: "PM"}
          - compare: {jsonpath_mini: "work_history.0.company", comparator: "eq", expected: "IBM"}
          - compare: {jsonpath_mini: "work_history.0.from_date", comparator: "eq", expected: "10/2012"}
          - compare: {jsonpath_mini: "work_history.0.position_title", comparator: "eq", expected: "JavaScript Developer"}
          - compare: {jsonpath_mini: "work_history.0.to_date", comparator: "eq", expected: "11/2014"}
          - compare: {jsonpath_mini: "work_history.1.company", comparator: "eq", expected: "Amazon"}
          - compare: {jsonpath_mini: "work_history.1.from_date", comparator: "eq", expected: "12/2014"}
          - compare: {jsonpath_mini: "work_history.1.position_title", comparator: "eq", expected: "Project Manager"}
          - compare: {jsonpath_mini: "work_history.1.to_date", comparator: "eq", expected: ""}
    - expected_status: [200] # ok

- test:
    - name: "Get user data"
    - url: "/users/2"
    - method: "GET"
    - validators:
          - compare: {jsonpath_mini: "id", comparator: "eq", expected: 2}
          - compare: {jsonpath_mini: "first_name", comparator: "eq", expected: "Jane"}
          - compare: {jsonpath_mini: "last_name", comparator: "eq", expected: "Doe"}
          - compare: {jsonpath_mini: "email", comparator: "eq", expected: "jane@doe.com"}
          - compare: {jsonpath_mini: "date_of_birth", comparator: "eq", expected: "01/11/1991"}
          - compare: {jsonpath_mini: "city", comparator: "eq", expected: "Madrid"}
          - compare: {jsonpath_mini: "summary", comparator: "eq", expected: "Hi, this is Jane Doe"}
          - compare: {jsonpath_mini: "skills.0.category", comparator: "eq", expected: "software"}
          - compare: {jsonpath_mini: "skills.0.description", comparator: "eq", expected: "Php programming language"}
          - compare: {jsonpath_mini: "skills.0.name", comparator: "eq", expected: "Php"}
          - compare: {jsonpath_mini: "skills.1.category", comparator: "eq", expected: "software"}
          - compare: {jsonpath_mini: "skills.1.description", comparator: "eq", expected: "Software Quality Assurance"}
          - compare: {jsonpath_mini: "skills.1.name", comparator: "eq", expected: "QA"}
          - compare: {jsonpath_mini: "work_history.0.company", comparator: "eq", expected: "Microsoft"}
          - compare: {jsonpath_mini: "work_history.0.from_date", comparator: "eq", expected: "10/2013"}
          - compare: {jsonpath_mini: "work_history.0.position_title", comparator: "eq", expected: "QA"}
          - compare: {jsonpath_mini: "work_history.0.to_date", comparator: "eq", expected: "11/2015"}
          - compare: {jsonpath_mini: "work_history.1.company", comparator: "eq", expected: "E-bay"}
          - compare: {jsonpath_mini: "work_history.1.from_date", comparator: "eq", expected: "12/2015"}
          - compare: {jsonpath_mini: "work_history.1.position_title", comparator: "eq", expected: "Php Developer"}
          - compare: {jsonpath_mini: "work_history.1.to_date", comparator: "eq", expected: ""}
    - expected_status: [200] # ok

- test:
    - name: "Delete nonexistent user"
    - url: "/users/4"
    - method: "DELETE"
    - validators:
          - compare: {jsonpath_mini: "error", comparator: "eq", expected: "User id 4 doesn't exist"}
    - expected_status: [404] # not found
